import{g as a,a as v,b as o,h as V,d as e,t as g,E as z,p as w,i as p,F as C,m as q,c as K,w as O,o as n,e as U,T as H,G as P,q as j}from"./app-D5HoBR2n.js";import{a as J,_ as Q}from"./useImageDropped-C-kjBIld.js";import{u as W}from"./useAlert-DXi6OtDz.js";import{_ as X}from"./Alerta-D7M1lK8y.js";import{_ as Y}from"./AuthenticatedLayout-CRy0OdIW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-BNIJFFrm.js";const Z={class:"p-6 border-t border-gray-100 dark:border-gray-800 sm:p-6"},ee={class:"space-y-5"},te={class:""},oe={class:"text-lg font-semibold text-gray-800 dark:text-white/90"},se={class:"flex items-center justify-between mb-6"},re={class:"flex items-center gap-3"},le={key:0,class:"mb-6 rounded-xl border border-gray-200 bg-gray-50 p-4"},ne={class:"mt-3 flex justify-end gap-2"},ae=["disabled"],ie={key:1,class:"grid grid-cols-2 gap-3 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5"},de=["src","alt"],ue={class:"absolute inset-0 flex items-center justify-center gap-2 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity"},ce=["onClick"],ge=["onClick"],me={class:"absolute bottom-1.5 left-1.5 rounded bg-black/50 px-1.5 py-0.5 text-xs text-white"},ve={key:2,class:"flex flex-col items-center justify-center rounded-xl border-2 border-dashed border-gray-300 py-20 text-center"},pe=["src","alt"],be={class:"absolute bottom-4 left-1/2 -translate-x-1/2 rounded-full bg-black/50 px-3 py-1 text-sm text-white"},je=Object.assign({layout:Y},{__name:"CourseGallery",props:{course:Object,images:Array},setup(i){const b=i,{alertState:u,warning:$,success:D,hideAlert:m}=W(),d=j(!1),{files:c,previews:M,isDragging:L,handleChange:A,handleDrop:B,handleDragEnter:E,handleDragLeave:F,removeAt:S,reset:f}=J({multiple:!0,maxFiles:20,maxSizeMB:2,acceptedTypes:["image/jpeg","image/png","image/jpg","image/webp"],onError:s=>alert(s)}),_=()=>{if(!c.value.length)return;const s=new FormData;c.value.forEach((t,l)=>s.append(`images[${l}]`,t)),w.post(route("courses.gallery.update",b.course.id),s,{forceFormData:!0,onSuccess:()=>{f(),d.value=!1}})},T=s=>{$("¿Eliminar esta foto?",{title:"Eliminar foto",buttonText:"Sí, eliminar",cancelText:"Cancelar",onConfirm:()=>I(s.id)})},I=s=>{m(),w.delete(route("courses.gallery.delete",{id:b.course.id,mediaId:s}),{onSuccess:()=>D("Foto eliminada correctamente")})},r=j({show:!1,index:0}),R=s=>{r.value={show:!0,index:s}},h=()=>{r.value.show=!1},y=()=>{r.value.index>0&&r.value.index--},k=()=>{r.value.index<b.images.length-1&&r.value.index++},G=s=>{r.value.show&&(s.key==="ArrowLeft"&&y(),s.key==="ArrowRight"&&k(),s.key==="Escape"&&h())};return(s,t)=>(n(),a(C,null,[v(o(V),{title:"Galería del curso"}),e("div",Z,[e("div",ee,[e("div",te,[e("h3",oe,"Galería del curso: "+g(i.course.topic),1),t[7]||(t[7]=e("p",{class:"text-sm text-gray-500"},"Sube o elimina fotos de la galería",-1))]),e("div",{onKeydown:G,tabindex:"-1"},[v(X,z(o(u),{onConfirm:t[0]||(t[0]=l=>o(u).onConfirm?o(u).onConfirm():o(m)()),onCancel:t[1]||(t[1]=l=>o(u).onCancel?o(u).onCancel():o(m)()),onClose:t[2]||(t[2]=l=>o(m)())}),null,16),e("div",se,[e("div",re,[e("button",{onClick:t[3]||(t[3]=l=>o(w).get(s.route("courses.index"))),class:"text-gray-500 hover:text-gray-700"}," ← Volver ")]),e("button",{onClick:t[4]||(t[4]=l=>d.value=!d.value),class:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700"},[...t[8]||(t[8]=[e("span",null,"+ Agregar más fotos",-1)])])]),d.value?(n(),a("div",le,[v(Q,{multiple:"",previews:o(M),"is-dragging":o(L),"max-files":20,onChange:o(A),onDrop:o(B),onDragEnter:o(E),onDragLeave:o(F),onRemoveAt:o(S),onRemove:o(f)},null,8,["previews","is-dragging","onChange","onDrop","onDragEnter","onDragLeave","onRemoveAt","onRemove"]),e("div",ne,[e("button",{onClick:t[5]||(t[5]=l=>{d.value=!1,o(f)()}),class:"rounded-lg border px-4 py-2 text-sm text-gray-600 hover:bg-gray-100"}," Cancelar "),e("button",{onClick:_,disabled:!o(c).length,class:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50"}," Subir "+g(o(c).length?`(${o(c).length})`:""),9,ae)])])):p("",!0),i.images.length?(n(),a("div",ie,[(n(!0),a(C,null,q(i.images,(l,x)=>(n(),a("div",{key:l.id,class:"group relative aspect-square overflow-hidden rounded-xl border border-gray-200 bg-gray-100"},[e("img",{src:l.thumb??l.url,alt:`Foto ${x+1}`,class:"h-full w-full object-cover transition-transform duration-200 group-hover:scale-105"},null,8,de),e("div",ue,[e("button",{onClick:N=>R(x),class:"rounded-full bg-white/90 p-2 text-gray-700 hover:bg-white"},[...t[9]||(t[9]=[e("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607zM10.5 7.5v6m3-3h-6"})],-1)])],8,ce),e("button",{onClick:N=>T(l),class:"rounded-full bg-red-500/90 p-2 text-white hover:bg-red-600"},[...t[10]||(t[10]=[e("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})],-1)])],8,ge)]),e("span",me,g(x+1),1)]))),128))])):(n(),a("div",ve,[t[11]||(t[11]=e("svg",{class:"h-12 w-12 text-gray-300",fill:"none",viewBox:"0 0 24 24","stroke-width":"1",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909M3 21h18M3.75 3h16.5M4.5 3v18M19.5 3v18"})],-1)),t[12]||(t[12]=e("p",{class:"mt-3 text-sm text-gray-500"},"No hay fotos todavía",-1)),e("button",{onClick:t[6]||(t[6]=l=>d.value=!0),class:"mt-3 text-sm font-medium text-blue-600 hover:text-blue-700"}," Agregar la primera foto ")])),(n(),K(P,{to:"body"},[v(H,{"enter-active-class":"transition-opacity duration-200","enter-from-class":"opacity-0","leave-active-class":"transition-opacity duration-200","leave-to-class":"opacity-0"},{default:O(()=>[r.value.show?(n(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/90",onClick:U(h,["self"])},[e("img",{src:i.images[r.value.index]?.url,alt:`Foto ${r.value.index+1}`,class:"max-h-[90vh] max-w-[90vw] rounded-lg object-contain shadow-2xl"},null,8,pe),e("button",{onClick:h,class:"absolute top-4 right-4 rounded-full bg-white/10 p-2 text-white hover:bg-white/20"},[...t[13]||(t[13]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])]),r.value.index>0?(n(),a("button",{key:0,onClick:y,class:"absolute left-4 rounded-full bg-white/10 p-3 text-white hover:bg-white/20"},[...t[14]||(t[14]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})],-1)])])):p("",!0),r.value.index<i.images.length-1?(n(),a("button",{key:1,onClick:k,class:"absolute right-4 rounded-full bg-white/10 p-3 text-white hover:bg-white/20"},[...t[15]||(t[15]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})],-1)])])):p("",!0),e("div",be,g(r.value.index+1)+" / "+g(i.images.length),1)])):p("",!0)]),_:1})]))],32)])])],64))}});export{je as default};
