import{y as k,c as _,w as i,d as a,t as p,b,j as C,x as B,f as I,q as g,p as j,o as D}from"./app-D5HoBR2n.js";import{_ as E}from"./Modal-B-XJAO6a.js";import{u as F}from"./useImageUpload-UuZ2t74A.js";const P={class:"p-6 space-y-4"},S={class:"mb-4"},z={class:"block text-sm font-medium text-gray-700 mb-2"},M={class:"w-full h-48 overflow-hidden rounded-lg border border-gray-300"},N=["src"],V=["disabled"],A=["disabled"],W={__name:"BannerEditModal",props:{show:{type:Boolean,default:!1},banner:{type:Object,default:null}},emits:["close","updated","warning","error"],setup(d,{emit:f}){const n=d,r=f,l=g({link:"",order:0,currentImage:null}),o=g(!1),{file:u,preview:m,handleChange:v,reset:c}=F({maxSizeMB:1,onError:e=>r("warning",e)});k(()=>n.banner,e=>{e&&(l.value={link:e.link||"",order:e.order??0,currentImage:e.image},c())},{immediate:!0});const x=()=>{l.value={link:"",order:0,currentImage:null},c()},s=()=>{x(),r("close")},h=e=>{v(e)},w=async()=>{if(!n.banner)return;o.value=!0;const e=new FormData;e.append("order",l.value.order),l.value.link&&l.value.link.trim()!==""&&e.append("link",l.value.link),u.value&&e.append("image",u.value),j.post(`/banners/${n.banner.id}`,e,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{s(),r("updated")},onError:()=>{r("error","Error al actualizar el banner")},onFinish:()=>{o.value=!1}})};return(e,t)=>(D(),_(E,{show:d.show,onClose:s,maxWidth:"2xl"},{title:i(()=>[...t[1]||(t[1]=[I(" Editar banner ",-1)])]),footer:i(()=>[a("button",{onClick:s,disabled:o.value,class:"rounded-md border border-transparent py-2 px-4 text-sm text-slate-600 transition-all hover:bg-slate-100 disabled:opacity-50"}," Cancelar ",8,V),a("button",{onClick:w,disabled:o.value,class:"rounded-md bg-blue-600 py-2 px-4 text-sm text-white transition-all shadow-md hover:bg-blue-700 hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"},p(o.value?"Actualizando...":"Actualizar banner"),9,A)]),default:i(()=>[a("div",P,[a("div",S,[a("label",z,p(b(m)?"Nueva imagen":"Imagen actual"),1),a("div",M,[a("img",{src:b(m)||l.value.currentImage,class:"w-full h-full object-cover",alt:"Banner actual"},null,8,N)])]),a("div",null,[t[2]||(t[2]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Cambiar imagen (opcional) ",-1)),a("input",{type:"file",accept:"image/jpeg,image/png,image/jpg,image/webp",onChange:h,class:"block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none"},null,32),t[3]||(t[3]=a("p",{class:"mt-1 text-xs text-gray-500"}," Formato permitido: JPG, PNG, WEBP (Peso max. 1MB). Deja vacio para mantener la imagen actual. ",-1))]),a("div",null,[t[4]||(t[4]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Link (opcional) ",-1)),C(a("input",{"onUpdate:modelValue":t[0]||(t[0]=y=>l.value.link=y),type:"text",placeholder:"https://ejemplo.com",class:"block w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[B,l.value.link]])])])]),_:1},8,["show"]))}};export{W as default};
