import{z as j,c as z,w as m,d as a,t as g,b as i,n as M,f as y,o as p,g as w,k as F,v as S,x as b,s as N}from"./app-IggChIWS.js";import{_ as P}from"./Modal-DP7vPZY9.js";import{u as V}from"./useImageUpload-DoJCaAGq.js";const $={class:"p-6 space-y-4"},L={class:"mb-4"},T={class:"block text-sm font-medium text-gray-700 mb-2"},A={class:"w-full h-48 overflow-hidden rounded-lg border border-gray-300"},G=["src"],O={key:0,class:"mt-1 text-xs text-gray-500 truncate"},U={key:1,class:"mt-1 text-xs text-gray-500"},W=["disabled"],q=["disabled"],Q={__name:"BannerEditModal",props:{show:{type:Boolean,default:!1},banner:{type:Object,default:null}},emits:["close","updated","warning","error"],setup(v,{emit:k}){const d=v,o=k,r=b({link:"",order:0,currentImage:null}),l=b(!1),s=b(!1),{file:n,preview:f,handleChange:x,reset:h}=V({maxSizeMB:1,onError:e=>o("warning",e)});j(()=>d.banner,e=>{e&&(r.value={link:e.link||"",order:e.order??0,currentImage:e.image},h())},{immediate:!0});const D=()=>{r.value={link:"",order:0,currentImage:null},h()},u=()=>{D(),o("close")},C=e=>{x(e)},B=e=>{e.preventDefault(),s.value=!0},I=e=>{e.preventDefault(),s.value=!1},E=e=>{e.preventDefault(),s.value=!1;const t=e.dataTransfer.files;if(!t||t.length===0)return;x({target:{files:t}})},_=async()=>{if(!d.banner)return;l.value=!0;const e=new FormData;e.append("order",r.value.order),r.value.link&&r.value.link.trim()!==""&&e.append("link",r.value.link),n.value&&e.append("image",n.value),N.post(`/banners/${d.banner.id}`,e,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{u(),o("updated")},onError:()=>{o("error","Error al actualizar el banner")},onFinish:()=>{l.value=!1}})};return(e,t)=>(p(),z(P,{show:v.show,onClose:u,maxWidth:"2xl"},{title:m(()=>[...t[2]||(t[2]=[y(" Editar banner ",-1)])]),footer:m(()=>[a("button",{onClick:u,disabled:l.value,class:"rounded-md border border-transparent py-2 px-4 text-sm text-slate-600 transition-all hover:bg-slate-100 disabled:opacity-50"}," Cancelar ",8,W),a("button",{onClick:_,disabled:l.value,class:"rounded-md bg-blue-600 py-2 px-4 text-sm text-white transition-all shadow-md hover:bg-blue-700 hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"},g(l.value?"Actualizando...":"Actualizar banner"),9,q)]),default:m(()=>[a("div",$,[a("div",L,[a("label",T,g(i(f)?"Nueva imagen":"Imagen actual"),1),a("div",A,[a("img",{src:i(f)||r.value.currentImage,class:"w-full h-full object-cover",alt:"Banner actual"},null,8,G)])]),a("div",null,[t[6]||(t[6]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Cambiar imagen (opcional) ",-1)),a("div",{onDragover:B,onDragleave:I,onDrop:E,onClick:t[0]||(t[0]=c=>e.$refs.fileInput.click()),class:M(["relative flex flex-col items-center justify-center w-full h-36 rounded-lg border-2 border-dashed cursor-pointer transition-all",s.value?"border-blue-500 bg-blue-50":"border-gray-300 bg-gray-50 hover:bg-gray-100 hover:border-gray-400"])},[t[3]||(t[3]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-10 w-10 mb-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1M12 12V4m0 0L8 8m4-4l4 4"})],-1)),t[4]||(t[4]=a("p",{class:"text-sm text-gray-500"},[a("span",{class:"font-medium text-blue-600"},"Haz clic para seleccionar"),y(" Â o arrastra y suelta aquÃ­ ")],-1)),t[5]||(t[5]=a("p",{class:"text-xs text-gray-400 mt-1"},"JPG, PNG, WEBP â€” MÃ¡x. 1MB",-1)),a("input",{ref:"fileInput",type:"file",accept:"image/jpeg,image/png,image/jpg,image/webp",onChange:C,class:"hidden"},null,544)],34),i(n)?(p(),w("p",O," ðŸ“Ž "+g(i(n).name),1)):(p(),w("p",U," Deja vacÃ­o para mantener la imagen actual. "))]),a("div",null,[t[7]||(t[7]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Link (opcional) ",-1)),F(a("input",{"onUpdate:modelValue":t[1]||(t[1]=c=>r.value.link=c),type:"text",placeholder:"https://ejemplo.com",class:"block w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[S,r.value.link]])])])]),_:1},8,["show"]))}};export{Q as default};
