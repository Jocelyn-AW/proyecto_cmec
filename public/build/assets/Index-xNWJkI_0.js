import{d as M}from"./vuedraggable.umd-BzGJhlsL.js";import{y as O,g as S,a as d,b as s,h as A,d as o,f as I,w as N,o as b,c as D,p as w,q as l,k as L}from"./app-DK0nqKl3.js";import{_ as V}from"./AuthenticatedLayout-huTq0u-n.js";import{_ as G}from"./Alerta-Cuz6Xr8h.js";import{u as U}from"./useAlert-UeAE-bRV.js";import W from"./PublicityEditModal-Bzb_ywB6.js";import q from"./PublicityCreateModal-CzGaKQoI.js";import F from"./PublicityListItem-D_bBhPvT.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-1ZfZOzJW.js";import"./Modal-zXR-PI-w.js";import"./useImageUpload-CL1QHweZ.js";const J={class:"p-6 border-t border-gray-100 dark:border-gray-800 sm:p-6 lg:p-8"},K={class:"space-y-5"},Q={class:"overflow-hidden rounded-2xl border border-gray-200 bg-white pt-4 dark:border-gray-800 dark:bg-white/[0.03]"},R={class:"flex flex-col sm:flex-row items-center justify-between gap-4 px-6 mb-4"},X={class:"block px-5 pb-4"},Y={class:"space-y-4"},Z=Object.assign({layout:V},{__name:"Index",props:{posts:{type:Array,default:()=>[]}},setup(y){const g=y,{alertState:a,success:u,errorA:c,warning:i}=U(),n=l([]),m=l([]),x=l(!1),p=l(!1),f=l(!1),v=l(null),h=L(()=>n.value.length===0?0:Math.max(...n.value.map(e=>e.order??0))+1);O(()=>g.posts,()=>{const r=[...g.posts].sort((e,t)=>(e.order??0)-(t.order??0));n.value=r.map(e=>({...e})),m.value=r.map(e=>({...e}))},{immediate:!0});const C=()=>{x.value=!0},k=()=>{x.value=!1},E=()=>{const r={posts:n.value.map((e,t)=>({id:e.id,order:t}))};w.post("/publicity/reorder",r,{preserveScroll:!0,onSuccess:()=>{m.value=n.value.map(e=>({...e})),u("Orden actualizado correctamente")},onError:()=>{c("Error actualizando el orden")}})},_=()=>{n.value=m.value.map(r=>({...r}))},T=r=>{const e=n.value.find(t=>t.id===r);if(!e){i("Publicidad no encontrada");return}v.value={...e},f.value=!0},$=r=>{i("¿Estás seguro de eliminar esta publicidad?",{title:"Eliminar publicidad",buttonText:"Eliminar",cancelText:"Cancelar",onConfirm:()=>{w.delete(`/publicity/${r}`,{preserveScroll:!0,onSuccess:()=>{u("Publicidad eliminada correctamente")},onError:()=>{c("Error al eliminar la publicidad")}})}})},P=()=>{u("La publicidad ha sido creada correctamente")},j=()=>{u("La publicidad ha sido actualizada correctamente")},z=()=>{a.value.onConfirm?.(),a.value.show=!1},B=()=>{a.value.onCancel?.(),a.value.show=!1};return(r,e)=>(b(),S("div",null,[d(s(A),{title:"Publicidad"}),o("div",J,[o("div",K,[e[11]||(e[11]=o("div",{class:"flex flex-col gap-5 px-6 mb-4 sm:flex-row sm:items-center sm:justify-between"},[o("div",null,[o("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white/90"},"Publicidad"),o("p",{class:"text-sm text-gray-500"},' Arrastra las filas para reordenar y pulsa "Guardar orden" ')])],-1)),o("div",Q,[o("div",R,[o("div",{class:"flex items-center gap-2 w-full sm:w-auto"},[o("button",{onClick:_,class:"inline-flex h-10 w-full sm:w-auto justify-center items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors"}," Cancelar "),o("button",{onClick:E,class:"inline-flex h-10 w-full sm:w-auto justify-center items-center gap-2 rounded-lg bg-zinc-900 text-white px-4 py-2.5 text-sm font-medium hover:bg-zinc-800 transition-colors"}," Guardar orden ")]),e[10]||(e[10]=o("p",{class:"text-sm text-amber-600 dark:text-amber-500"}," ⚠️ Las imágenes deben pesar máximo 1MB ",-1)),o("button",{onClick:e[0]||(e[0]=t=>p.value=!0),class:"inline-flex h-10 w-full sm:w-auto justify-center items-center gap-2 rounded-lg bg-green-600 text-white px-4 py-2.5 text-sm font-medium hover:bg-green-700 transition-colors shadow-sm"},[...e[9]||(e[9]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5"},[o("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1),I(" Nueva publicidad ",-1)])])]),o("div",X,[o("div",Y,[d(s(M),{list:n.value,"ghost-class":"ghost","item-key":"id",onStart:C,onEnd:k},{item:N(({element:t})=>[(b(),D(F,{key:t.id,post:t,onEdit:T,onDelete:$},null,8,["post"]))]),_:1},8,["list"])])])])])]),d(q,{show:p.value,"next-order":h.value,onClose:e[1]||(e[1]=t=>p.value=!1),onCreated:P,onWarning:e[2]||(e[2]=t=>s(i)(t)),onError:e[3]||(e[3]=t=>s(c)(t)),onInfo:e[4]||(e[4]=t=>s(i)(t))},null,8,["show","next-order"]),d(W,{show:f.value,post:v.value,onClose:e[5]||(e[5]=t=>{f.value=!1,v.value=null}),onUpdated:j,onWarning:e[6]||(e[6]=t=>s(i)(t)),onError:e[7]||(e[7]=t=>s(c)(t))},null,8,["show","post"]),d(G,{show:s(a).show,message:s(a).message,title:s(a).title,type:s(a).type,buttonText:s(a).buttonText,cancelText:s(a).cancelText,onConfirm:z,onCancel:B,onClose:e[8]||(e[8]=t=>s(a).show=!1)},null,8,["show","message","title","type","buttonText","cancelText"])]))}}),pe=H(Z,[["__scopeId","data-v-2fd6f658"]]);export{pe as default};
