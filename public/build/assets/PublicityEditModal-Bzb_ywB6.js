import{y as h,c as k,w as u,d as e,t as f,b as s,j as _,x as C,f as I,q as v,p as j,o as B}from"./app-DK0nqKl3.js";import{_ as P}from"./Modal-zXR-PI-w.js";import{u as D}from"./useImageUpload-CL1QHweZ.js";const E={class:"p-6 space-y-4"},F={class:"mb-4"},S={class:"block text-sm font-medium text-gray-700 mb-2"},z={class:"w-full h-48 overflow-hidden rounded-lg border border-gray-300"},M=["src"],N=["disabled"],V=["disabled"],U={__name:"PublicityEditModal",props:{show:{type:Boolean,default:!1},post:{type:Object,default:null}},emits:["close","updated","warning","error"],setup(m,{emit:x}){const i=m,r=x,l=v({link:"",order:0,currentImage:null}),o=v(!1),{file:c,preview:p,handleChange:b,reset:g}=D({maxSizeMB:1,onError:a=>r("warning",a)});h(()=>i.post,a=>{a&&(l.value={link:a.link||"",order:a.order??0,currentImage:a.image},g())},{immediate:!0});const w=()=>{l.value={link:"",order:0,currentImage:null},g()},n=()=>{w(),r("close")},y=()=>{if(!i.post)return;o.value=!0;const a=new FormData;a.append("order",l.value.order),l.value.link&&l.value.link.trim()!==""&&a.append("link",l.value.link),c.value&&a.append("image",c.value),j.post(`/publicity/${i.post.id}`,a,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{n(),r("updated")},onError:()=>{r("error","Error al actualizar la publicidad")},onFinish:()=>{o.value=!1}})};return(a,t)=>(B(),k(P,{show:m.show,onClose:n,maxWidth:"2xl"},{title:u(()=>[...t[2]||(t[2]=[I(" Editar publicidad ",-1)])]),footer:u(()=>[e("button",{onClick:n,disabled:o.value,class:"rounded-md border border-transparent py-2 px-4 text-sm text-slate-600 transition-all hover:bg-slate-100 disabled:opacity-50"}," Cancelar ",8,N),e("button",{onClick:y,disabled:o.value,class:"rounded-md bg-blue-600 py-2 px-4 text-sm text-white transition-all shadow-md hover:bg-blue-700 hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"},f(o.value?"Actualizando...":"Actualizar publicidad"),9,V)]),default:u(()=>[e("div",E,[e("div",F,[e("label",S,f(s(p)?"Nueva imagen":"Imagen actual"),1),e("div",z,[e("img",{src:s(p)||l.value.currentImage,class:"w-full h-full object-cover",alt:"Publicidad"},null,8,M)])]),e("div",null,[t[3]||(t[3]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Cambiar imagen (opcional) ",-1)),e("input",{type:"file",accept:"image/jpeg,image/png,image/jpg,image/webp",onChange:t[0]||(t[0]=(...d)=>s(b)&&s(b)(...d)),class:"block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none"},null,32),t[4]||(t[4]=e("p",{class:"mt-1 text-xs text-gray-500"}," Formato permitido: JPG, PNG, WEBP (Peso máx. 1MB). Deja vacío para mantener la imagen actual. ",-1))]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Link (opcional) ",-1)),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=d=>l.value.link=d),type:"text",placeholder:"https://ejemplo.com",class:"block w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[C,l.value.link]])])])]),_:1},8,["show"]))}};export{U as default};
